IF
	OR(3)
        !Allegiance(Myself,ENEMY)
        !See(NearestEnemyOf(Myself))
        Global("RZ_See_Enemy","LOCALS",0)
THEN
	RESPONSE #100
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL7I",Myself)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(11)
                NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],1)
		!See([GOODCUTOFF.0.0.0.0.SUMMONED])
		CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],0,WIZARD_SPELL_TURNING)
		!CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],0,WIZARD_SPELL_TRAP)
		StateCheck([GOODCUTOFF.0.0.0.0.SUMMONED],RZ_STATE_DISABLED)
		StateCheck([GOODCUTOFF.0.0.0.0.SUMMONED],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],0,MINORGLOBE)
		!CheckStat([GOODCUTOFF.0.0.0.0.SUMMONED],0,SANCTUARY)
        OR(12)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL7I",Myself)
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	!Allegiance(LastSeenBy(Myself),ENEMY)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL7I",LastSeenBy(Myself))
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(8)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(8)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(7)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(8)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],2,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(8)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],2,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)
	RandomNumGT(20,5)
	OR(2)
		!HaveSpell(WIZARD_SLOW)
		RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_GLITTERDUST)
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	!GlobalTimerNotExpired("RZ_Cast_Slow_Timer","LOCALS")
	OR(2)
		HasItem("SCRL1O",Myself) // Slow
		HaveSpell(WIZARD_SLOW)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(11)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,CLERIC_FREE_ACTION)
		Class([PC],MONK)
		StateCheck([PC],STATE_SLOWED)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
                RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(SecondNearest([PC]),MONK)
		StateCheck(SecondNearest([PC]),STATE_SLOWED)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
	        RandomNumGT(20,12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(ThirdNearest([PC]),MONK)
		StateCheck(ThirdNearest([PC]),STATE_SLOWED)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
	        RandomNumGT(20,13)
        	NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(FourthNearest([PC]),MONK)
		StateCheck(FourthNearest([PC]),STATE_SLOWED)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(FifthNearest([PC]),MONK)
		StateCheck(FifthNearest([PC]),STATE_SLOWED)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(SixthNearest([PC]),MONK)
		StateCheck(SixthNearest([PC]),STATE_SLOWED)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,CLERIC_FREE_ACTION)
		Class([PC],MONK)
		StateCheck([PC],STATE_SLOWED)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(SecondNearest([PC]),MONK)
		StateCheck(SecondNearest([PC]),STATE_SLOWED)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(ThirdNearest([PC]),MONK)
		StateCheck(ThirdNearest([PC]),STATE_SLOWED)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(FourthNearest([PC]),MONK)
		StateCheck(FourthNearest([PC]),STATE_SLOWED)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(FifthNearest([PC]),MONK)
		StateCheck(FifthNearest([PC]),STATE_SLOWED)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(10)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,CLERIC_FREE_ACTION)
		Class(SixthNearest([PC]),MONK)
		StateCheck(SixthNearest([PC]),STATE_SLOWED)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
         False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	!GlobalTimerNotExpired("RZ_Cast_Slow_Timer","LOCALS")
	HaveSpell(WIZARD_SLOW)
	RandomNumGT(20,5)
	OR(2)
		!HaveSpell(WIZARD_GLITTERDUST)
		RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Slow_Timer","LOCALS",24)
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_SLOW)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	!GlobalTimerNotExpired("RZ_Slow_Timer","LOCALS")
	HasItem("SCRL1O",Myself) // Slow
	RandomNumGT(20,10)
	OR(2)
		!HaveSpell(WIZARD_GLITTERDUST)
		RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Slow_Timer","LOCALS",24)
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL1O",LastSeenBy(Myself)) // Slow
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	OR(6)
		HaveSpell(WIZARD_CHAOS)
		HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
		HaveSpell(WIZARD_CONFUSION)
		HasItem("SCRL5P",Myself)
		HasItem("SCRL5Q",Myself)
		HasItem("SCRLA8",Myself)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(12)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
        OR(12)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
        OR(11)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHAOS)
	RandomNumGT(20,5)
	OR(2)
		!HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
		RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_CHAOS)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_CONFUSION)
	RandomNumGT(20,5)
	OR(2)
		!HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
		RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_CONFUSION)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
	RandomNumGT(20,5)
	OR(2)
		!HaveSpell(WIZARD_CHAOS)
		RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_CONFUSION)
	RandomNumGT(20,5)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_CONFUSION)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL5P",Myself)
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL5P",LastSeenBy(Myself))
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL5Q",Myself)
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL5Q",LastSeenBy(Myself))
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRLA8",Myself)
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRLA8",LastSeenBy(Myself))
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL5L",Myself) // Slow
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(8)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(8)
                RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(8)
	        RandomNumGT(20,12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(8)
	        RandomNumGT(20,13)
        	NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(8)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(7)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(7)
                RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(7)
	        RandomNumGT(20,12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(7)
	        RandomNumGT(20,13)
        	NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(7)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(6)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
         False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL5L",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL5L",LastSeenBy(Myself)) // Slow
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_HOLD_PERSON) // Hold Person
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(19)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
		Kit([PC],INQUISITOR)
		Kit([PC],UNDEADHUNTER)
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		!CheckStat([PC],0,CLERIC_FREE_ACTION)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		StateCheck([PC],RZ_STATE_DISABLED)
		!CheckStat([PC],0,HELD)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(19)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		Kit(SecondNearest([PC]),INQUISITOR)
		Kit(SecondNearest([PC]),UNDEADHUNTER)
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SecondNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SecondNearest([PC]),0,HELD)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(19)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		Kit(ThirdNearest([PC]),INQUISITOR)
		Kit(ThirdNearest([PC]),UNDEADHUNTER)
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(ThirdNearest([PC]),0,HELD)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(19)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		Kit(FourthNearest([PC]),INQUISITOR)
		Kit(FourthNearest([PC]),UNDEADHUNTER)
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FourthNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FourthNearest([PC]),0,HELD)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(19)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		Kit(FifthNearest([PC]),INQUISITOR)
		Kit(FifthNearest([PC]),UNDEADHUNTER)
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FifthNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FifthNearest([PC]),0,HELD)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(19)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		Kit(SixthNearest([PC]),INQUISITOR)
		Kit(SixthNearest([PC]),UNDEADHUNTER)
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SixthNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SixthNearest([PC]),0,HELD)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(18)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
		Kit([PC],INQUISITOR)
		Kit([PC],UNDEADHUNTER)
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		!CheckStat([PC],0,CLERIC_FREE_ACTION)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		StateCheck([PC],RZ_STATE_DISABLED)
		!CheckStat([PC],0,HELD)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(18)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		Kit(SecondNearest([PC]),INQUISITOR)
		Kit(SecondNearest([PC]),UNDEADHUNTER)
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SecondNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SecondNearest([PC]),0,HELD)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(18)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		Kit(ThirdNearest([PC]),INQUISITOR)
		Kit(ThirdNearest([PC]),UNDEADHUNTER)
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(ThirdNearest([PC]),0,HELD)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(18)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		Kit(FourthNearest([PC]),INQUISITOR)
		Kit(FourthNearest([PC]),UNDEADHUNTER)
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FourthNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FourthNearest([PC]),0,HELD)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(18)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		Kit(FifthNearest([PC]),INQUISITOR)
		Kit(FifthNearest([PC]),UNDEADHUNTER)
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FifthNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FifthNearest([PC]),0,HELD)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(18)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		Kit(SixthNearest([PC]),INQUISITOR)
		Kit(SixthNearest([PC]),UNDEADHUNTER)
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SixthNearest([PC]),0,CLERIC_FREE_ACTION)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SixthNearest([PC]),0,HELD)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("R_ZAction_Timer","LOCALS")
	HaveSpell(WIZARD_HOLD_PERSON) // Hold Person
	RandomNumGT(20,10)
	OR(2)
	     RandomNumGT(20,10)
	     !HaveSpell(WIZARD_SLOW)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStat(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	CheckStat(LastSeenBy(Myself),0,HELD)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_HOLD_PERSON) // Hold Person
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	OR(6)
	    HasItem("SCRL8B",Myself) // Slow
	    HasItem("SCRL7W",Myself) // Slow
	    HasItem("SCRL7E",Myself) // Slow
	    HasItem("SCRL6R",Myself) // Slow
	    HasItem("SCRL2G",Myself) // Slow
	    HasItem("SCRL2A",Myself) // Slow
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(6)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(6)
                RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(6)
	        RandomNumGT(20,12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(6)
	        RandomNumGT(20,13)
        	NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(6)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(6)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(5)
		NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(5)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(5)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(5)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(5)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(5)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(5)
                RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(5)
	        RandomNumGT(20,12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(5)
	        RandomNumGT(20,13)
        	NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(4)
		NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(4)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(4)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(4)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(4)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(4)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
         False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL8B",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL8B",LastSeenBy(Myself)) // Slow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL7W",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL7W",LastSeenBy(Myself)) // Slow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL7E",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL7E",LastSeenBy(Myself)) // Slow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL6R",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL6R",LastSeenBy(Myself)) // Slow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL2G",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL2G",LastSeenBy(Myself)) // Slow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL2A",Myself) // Slow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL2A",LastSeenBy(Myself)) // Slow
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_HORROR)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(18)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
                Kit([PC],CAVALIER)
		!CheckStat([PC],0,WIZARD_RESIST_FEAR)
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		!CheckStat([PC],0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(18)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		Kit(SecondNearest([PC]),CAVALIER)
		!CheckStat(SecondNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SecondNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(18)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		Kit(ThirdNearest([PC]),CAVALIER)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(18)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		Kit(FourthNearest([PC]),CAVALIER)
		!CheckStat(FourthNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FourthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(18)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		Kit(FifthNearest([PC]),CAVALIER)
		!CheckStat(FifthNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FifthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(18)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		Kit(SixthNearest([PC]),CAVALIER)
		!CheckStat(SixthNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SixthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(17)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
                Kit([PC],CAVALIER)
		!CheckStat([PC],0,WIZARD_RESIST_FEAR)
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		!CheckStat([PC],0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(17)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		Kit(SecondNearest([PC]),CAVALIER)
		!CheckStat(SecondNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SecondNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(17)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		Kit(ThirdNearest([PC]),CAVALIER)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(17)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		Kit(FourthNearest([PC]),CAVALIER)
		!CheckStat(FourthNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FourthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(17)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		Kit(FifthNearest([PC]),CAVALIER)
		!CheckStat(FifthNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(FifthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(17)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		Kit(SixthNearest([PC]),CAVALIER)
		!CheckStat(SixthNearest([PC]),0,WIZARD_RESIST_FEAR)
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		!CheckStat(SixthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_HORROR)
	RandomNumGT(20,5)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	!Kit(LastSeenBy(Myself),CAVALIER)
	CheckStat(LastSeenBy(Myself),0,WIZARD_RESIST_FEAR)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_HORROR)
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_RAY_OF_ENFEEBLEMENT)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
        OR(12)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],1)
		!See([PC])
		CheckStat([PC],4,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),4,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_RAY_OF_ENFEEBLEMENT)
	RandomNumGT(20,5)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_RAY_OF_ENFEEBLEMENT)
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_SKULL_TRAP)
	Allegiance(Myself,ENEMY)
	OR(2)
	     !Range(NearestEnemyOf(Myself),14)
	     StateCheck(Myself,STATE_MIRRORIMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
        OR(15)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],STATE_MIRRORIMAGE)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(15)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(15)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(15)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(15)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(15)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(14)
		NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],STATE_MIRRORIMAGE)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(14)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(14)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(14)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(14)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(14)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(14)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],STATE_MIRRORIMAGE)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(14)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(14)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(14)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(14)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(14)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(13)
		NumCreatureLT([PC],1)
		!See([PC])
		StateCheck([PC],STATE_MIRRORIMAGE)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat([PC],1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat([PC],7,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(13)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SecondNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SecondNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(13)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(ThirdNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(ThirdNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(13)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FourthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FourthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(13)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(FifthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(FifthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(13)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_ENERGY)
		CheckStat(SixthNearest([PC]),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
		CheckStat(SixthNearest([PC]),7,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_SKULL_TRAP)
	RandomNumGT(20,5)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	OR(2)
	     !Range(LastSeenBy(Myself),14)
	     StateCheck(Myself,STATE_MIRRORIMAGE)
        !StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_PROTECTION_FROM_ENERGY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_SKULL_TRAP)
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	OR(3)
		HaveSpell(WIZARD_FLAME_ARROW)
		HasItem("SCRL1F",Myself) // Flame Arrow
		HaveSpell(WIZARD_MELF_ACID_ARROW)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(13)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],2,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(13)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],2,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],2,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],2,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),2,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_FLAME_ARROW)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_MELF_ACID_ARROW)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_FLAME_ARROW)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL1F",Myself) // Flame Arrow
	RandomNumGT(20,10)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_MELF_ACID_ARROW)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL1F",LastSeenBy(Myself)) // Flame Arrow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_MELF_ACID_ARROW)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_FLAME_ARROW)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_MELF_ACID_ARROW)
END


IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	OR(7)
		HaveSpell(WIZARD_AGANNAZAR_SCORCHER)
		HaveSpell(WIZARD_MAGIC_MISSILE)
		HaveSpell(WIZARD_CHROMATIC_ORB)
		HaveSpell(WIZARD_LIGHTNING_BOLT)
		HasItem("SCRL77",Myself) // Magic Missile
		HasItem("SCRL7S",Myself) // Magic Missile
		HasItem("SCRL2F",Myself) // Magic Missile
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(13)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],6,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(13)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],6,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],6,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],6,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),6,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHROMATIC_ORB)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_MAGIC_MISSILE)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_CHROMATIC_ORB)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_LIGHTNING_BOLT)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_MAGIC_MISSILE)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_LIGHTNING_BOLT)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_MAGIC_MISSILE)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_CHROMATIC_ORB)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_MAGIC_MISSILE)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL77",Myself) // Flame Arrow
	RandomNumGT(20,10)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_CHROMATIC_ORB)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL77",LastSeenBy(Myself)) // Flame Arrow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL7S",Myself) // Flame Arrow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL7S",LastSeenBy(Myself)) // Flame Arrow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HasItem("SCRL2F",Myself) // Flame Arrow
	RandomNumGT(20,10)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		UseItem("SCRL2F",LastSeenBy(Myself)) // Flame Arrow
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_AGANNAZAR_SCORCHER)
	RandomNumGT(20,5)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_AGANNAZAR_SCORCHER)
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	OR(2)
		HaveSpell(WIZARD_BLINDNESS)
		HaveSpell(WIZARD_SPOOK)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(20)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
		!CheckStat([PC],0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		!CheckStat([PC],0,WIZARD_RESIST_FEAR)
		Kit([PC],CAVALIER)
		StateCheck([PC],STATE_BLIND)
		CheckStat([PC],5,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(20)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		!CheckStat(SecondNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(SecondNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(SecondNearest([PC]),CAVALIER)
		StateCheck(SecondNearest([PC]),STATE_BLIND)
		CheckStat(SecondNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(20)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		!CheckStat(ThirdNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(ThirdNearest([PC]),CAVALIER)
		StateCheck(ThirdNearest([PC]),STATE_BLIND)
		CheckStat(ThirdNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(20)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		!CheckStat(FourthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(FourthNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(FourthNearest([PC]),CAVALIER)
		StateCheck(FourthNearest([PC]),STATE_BLIND)
		CheckStat(FourthNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(20)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		!CheckStat(FifthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(FifthNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(FifthNearest([PC]),CAVALIER)
		StateCheck(FifthNearest([PC]),STATE_BLIND)
		CheckStat(FifthNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(20)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		!CheckStat(SixthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(SixthNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(SixthNearest([PC]),CAVALIER)
		StateCheck(SixthNearest([PC]),STATE_BLIND)
		CheckStat(SixthNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(19)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		HasItem("IMOENHP1",[PC]) // Imoen's Belt
		!CheckStat([PC],0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat([PC],1,SCRIPTINGSTATE4)
		CheckStat([PC],2,SCRIPTINGSTATE3)
		!CheckStat([PC],0,WIZARD_RESIST_FEAR)
		Kit([PC],CAVALIER)
		StateCheck([PC],STATE_BLIND)
		CheckStat([PC],5,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(19)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",SecondNearest([PC])) // Imoen's Belt
		!CheckStat(SecondNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SecondNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SecondNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(SecondNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(SecondNearest([PC]),CAVALIER)
		StateCheck(SecondNearest([PC]),STATE_BLIND)
		CheckStat(SecondNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(19)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",ThirdNearest([PC])) // Imoen's Belt
		!CheckStat(ThirdNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(ThirdNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(ThirdNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(ThirdNearest([PC]),CAVALIER)
		StateCheck(ThirdNearest([PC]),STATE_BLIND)
		CheckStat(ThirdNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(19)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",FourthNearest([PC])) // Imoen's Belt
		!CheckStat(FourthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FourthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FourthNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(FourthNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(FourthNearest([PC]),CAVALIER)
		StateCheck(FourthNearest([PC]),STATE_BLIND)
		CheckStat(FourthNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(19)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",FifthNearest([PC])) // Imoen's Belt
		!CheckStat(FifthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(FifthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(FifthNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(FifthNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(FifthNearest([PC]),CAVALIER)
		StateCheck(FifthNearest([PC]),STATE_BLIND)
		CheckStat(FifthNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(19)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		HasItem("IMOENHP1",SixthNearest([PC])) // Imoen's Belt
		!CheckStat(SixthNearest([PC]),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStat(SixthNearest([PC]),1,SCRIPTINGSTATE4)
		CheckStat(SixthNearest([PC]),2,SCRIPTINGSTATE3)
		!CheckStat(SixthNearest([PC]),0,WIZARD_RESIST_FEAR)
		Kit(SixthNearest([PC]),CAVALIER)
		StateCheck(SixthNearest([PC]),STATE_BLIND)
		CheckStat(SixthNearest([PC]),5,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_BLINDNESS)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_SPOOK)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_BLINDNESS)
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_SPOOK)
	RandomNumGT(20,5)
	OR(2)
		RandomNumGT(20,10)
		!HaveSpell(WIZARD_BLINDNESS)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!HasItem("IMOENHP1",LastSeenBy(Myself)) // Imoen's Belt
	CheckStat(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
	!CheckStat(LastSeenBy(Myself),2,SCRIPTINGSTATE3)
	CheckStat(LastSeenBy(Myself),0,WIZARD_RESIST_FEAR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_SPOOK)
END

IF
        See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_BURNING_HANDS)
	Allegiance(Myself,ENEMY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(13)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(13)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(13)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],RZ_STATE_DISABLED)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,10)
                NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(12)
		RandomNumGT(20,11)
                NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,12)
                NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,13)
                NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,14)
                NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(12)
		RandomNumGT(20,15)
                NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],1)
		!See([PC])
		HasItemEquiped("CLCK26",[PC]) // Cloak of Mirroring
		CheckStat([PC],8,WIZARD_SPELL_IMMUNITY)
		!CheckStat([PC],0,WIZARD_SPELL_DEFLECTION)
		!CheckStat([PC],0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat([PC],0,WIZARD_SPELL_TURNING)
		!CheckStat([PC],0,WIZARD_SPELL_TRAP)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,MINORGLOBE)
		!CheckStat([PC],0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],2)
		!See(SecondNearest([PC]))
		HasItemEquiped("CLCK26",SecondNearest([PC])) // Cloak of Mirroring
		CheckStat(SecondNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SecondNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SecondNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],3)
		!See(ThirdNearest([PC]))
		HasItemEquiped("CLCK26",ThirdNearest([PC])) // Cloak of Mirroring
		CheckStat(ThirdNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(ThirdNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(ThirdNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],4)
		!See(FourthNearest([PC]))
		HasItemEquiped("CLCK26",FourthNearest([PC])) // Cloak of Mirroring
		CheckStat(FourthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FourthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FourthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],5)
		!See(FifthNearest([PC]))
		HasItemEquiped("CLCK26",FifthNearest([PC])) // Cloak of Mirroring
		CheckStat(FifthNearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(FifthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(FifthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(11)
		NumCreatureLT([PC],6)
		!See(SixthNearest([PC]))
		HasItemEquiped("CLCK26",SixthNearest([PC])) // Cloak of Mirroring
		CheckStat(Nearest([PC]),8,WIZARD_SPELL_IMMUNITY)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_DEFLECTION)
		!CheckStat(SixthNearest([PC]),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TURNING)
		!CheckStat(SixthNearest([PC]),0,WIZARD_SPELL_TRAP)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Action_Timer","LOCALS")
	HaveSpell(WIZARD_BURNING_HANDS)
	RandomNumGT(20,5)
	Allegiance(Myself,ENEMY)
	See(LastSeenBy(Myself))
	Allegiance(LastSeenBy(Myself),PC)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself)) // Cloak of Mirroring
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,20,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobalTimer("RZ_Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_BURNING_HANDS)
END